<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script
      src="https://kit.fontawesome.com/14edae483b.js"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="./assets/css/navbar.css">
  </head>
  <body>
    <nav>
      <div class="menu">
        <div class="nav-items">
          <ul>
            <li>
              <a href="#" class="menu-item"><i class="fa fa-code"></i></a>
            </li>
            <li><a href="#" class="menu-item">All</a></li>
            <li><a href="#" class="menu-item">T-Shirts</a></li>
            <li><a href="#" class="menu-item">Hoodies</a></li>
            <li><a href="#" class="menu-item">Mugs</a></li>
            <li><a href="#" class="menu-item">Caps</a></li>
            <li>
              <a href="#" id="search" class="menu-item"
                ><i class="fa fa-search"></i
              ></a>
            </li>
            <li>
              <a href="#" class="menu-item"
                ><i class="fa fa-shopping-cart"></i
              ></a>
            </li>
          </ul>
        </div>
        <div class="search-form">
          <form>
            <input
              class="nav-search"
              type="text"
              name=""
              placeholder="Search"
              oninput="updateSearchBox()"
            />
          </form>
          <a href="#" class="close"><i class="fa fa-times"></i></a>
        </div>
        <div class="search-box">
          <section>
            <div class="quick-links">
              <h3>Quick Links</h3>
              <ul>
                <li><a href="#">Blank Page</a></li>
                <li><a href="#">Blank Page</a></li>
                <li><a href="#">Blank Page</a></li>
                <li><a href="#">Blank Page</a></li>
              </ul>
            </div>
          </section>
        </div>
      </div>
    </nav>
    <div class="shadow"></div>
    <script
      src="https://code.jquery.com/jquery-3.6.0.min.js"
      integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
      crossorigin="anonymous"
    ></script>
    <script>
      function updateSearchBox() {
        $(".quick-links").empty();
        $(".quick-links").append("<ul class='serach-res'>");
        const searchTerm = $(".nav-search").val();
        $.get("/pages/", function (data) {
          data.forEach((page) => {
            const sim = similarity(searchTerm, page.title);
            if (sim > 0.3) {
              $(".search-res").append(`<li><a href="${page.path}">page.title</a></li>`)
            }
          });
        });
      }
      $(document).ready(function () {
        $("#search").on("click", function () {
          $(".menu-item").addClass("hide-item");
          $(".search-form").addClass("active");
          $(".close").addClass("active");
          $(".shadow").addClass("active");
          $(".search-box").addClass("active");
        });
        $(".close").on("click", function () {
          close();
        });
        $(".shadow").on("click", function () {
          close();
        });
        function close() {
          $(".menu-item").removeClass("hide-item");
          $(".search-form").removeClass("active");
          $(".close").removeClass("active");
          $(".shadow").removeClass("active");
          $(".search-box").removeClass("active");
        }
        function similarity(s1, s2) {
          var longer = s1;
          var shorter = s2;
          if (s1.length < s2.length) {
            longer = s2;
            shorter = s1;
          }
          var longerLength = longer.length;
          if (longerLength == 0) {
            return 1.0;
          }
          return (
            (longerLength - editDistance(longer, shorter)) /
            parseFloat(longerLength)
          );
        }

        function editDistance(s1, s2) {
          s1 = s1.toLowerCase().replace(/(\((.*?)\))/g, "");
          s2 = s2.toLowerCase().replace(/(\((.*?)\))/g, "");
          s1 = s1.replace(/(\<(.*?)\>)/g, "");
          s2 = s2.replace(/(\<(.*?)\>)/g, "");

          var costs = new Array();
          for (var i = 0; i <= s1.length; i++) {
            var lastValue = i;
            for (var j = 0; j <= s2.length; j++) {
              if (i == 0) costs[j] = j;
              else {
                if (j > 0) {
                  var newValue = costs[j - 1];
                  if (s1.charAt(i - 1) != s2.charAt(j - 1))
                    newValue =
                      Math.min(Math.min(newValue, lastValue), costs[j]) + 1;
                  costs[j - 1] = lastValue;
                  lastValue = newValue;
                }
              }
            }
            if (i > 0) costs[s2.length] = lastValue;
          }
          return costs[s2.length];
        }
      });
    </script>
  </body>
</html>
